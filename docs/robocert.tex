\documentclass[a4paper]{memoir}
\usepackage[T1]{fontenc}
\usepackage{microtype}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{braket} % set-builder notation
\usepackage{booktabs}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{stmaryrd}
\usepackage{circus}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tikz}
% fonts
\usepackage{stix}
\usepackage{tgtermes}
% while we don't technically need to load Heros here (we only use it for
% \metarefs), we do so to make sure it gets scaled.
\usepackage[scale=0.88]{tgheros}
\usepackage[scale=0.88]{tgadventor}
\usepackage[scaled]{beramono}

\usepackage{hyperref}
\usepackage{cleveref}

\usetikzlibrary{arrows.meta,matrix,positioning,quotes,shapes,calc,fit}
\colorlet{ZedColor}{black}
\colorlet{TColor}{gray!70!white}

\input{defs/tnotation}
\input{defs/gnotation}

% RFC 2119 keywords
\newcommand{\rfckw}[1]{\textbf{#1}}
\newcommand{\rfcmust}{\rfckw{must}}
\newcommand{\rfcmustnot}{\rfckw{must not}}
\newcommand{\rfcrequired}{\rfckw{required}}
\newcommand{\rfcshall}{\rfckw{shall}}
\newcommand{\rfcshallnot}{\rfckw{shall not}}
\newcommand{\rfcshould}{\rfckw{should}}
\newcommand{\rfcshouldnot}{\rfckw{should not}}
\newcommand{\rfcrecommended}{\rfckw{recommended}}
\newcommand{\rfcnotrecommended}{\rfckw{not recommended}}
\newcommand{\rfcmay}{\rfckw{may}}
\newcommand{\rfcoptional}{\rfckw{optional}}

% Open question.
\newcommand{\todo}[1]{\textcolor{orange}{(#1)}}

\newcommand{\ghissue}[1]{\href{https://github.com/UoY-RoboStar/robocert-sequences/#1}{\##1}}

\newcommand{\metaref}[1]{{\fontfamily{qhv}\selectfont #1}}
\newcommand{\langname}{{\sffamily\itshape RoboCert}}
\newcommand{\robochart}{{\sffamily\itshape RoboChart}}

\theoremstyle{definition}
\newtheorem{defn}{Definition}

\newcommand{\thead}[1]{\textbf{#1}}
\newcommand{\tsubhead}[1]{\textit{#1}}

\setlrmarginsandblock{2.5cm}{2cm}{*}
\setulmarginsandblock{2cm}{*}{1}
\setmarginnotes{0.25cm}{0.5cm}{1cm}
\checkandfixthelayout

\setsecnumdepth{subsection}

\makepagestyle{sruled}
\makeevenfoot {sruled}{}{}{}
\makeoddfoot  {sruled}{}{}{}
\makeheadrule {sruled}{\textwidth}{\normalrulethickness}
\makeevenhead {sruled}{\sffamily\thepage}{}{\sffamily\rightmark}
\makeoddhead  {sruled}{\sffamily\bfseries\leftmark}{}{\sffamily\thepage}

\makepsmarks{sruled}{%
   \nouppercaseheads
   \createmark{chapter}{left}{shownumber}{}{. \space}
   \createmark{section}{right}{shownumber}{}{. \space}
   \createplainmark{toc}{both}{\contentsname}
   \createplainmark{lof}{both}{\listfigurename}
   \createplainmark{lot}{both}{\listtablename}
   \createplainmark{bib}{both}{\bibname}
   \createplainmark{index}{both}{\indexname}
   \createplainmark{glossary}{both}{\glossaryname}}

\title{\langname{} Reference Manual}
\author{Matt Windsor}

\begin{document}

\headstyles{komalike}
\chapterstyle{madsen}
\pagestyle{sruled}

\frontmatter

\begin{titlingpage}
\aliaspagestyle{titlingpage}{plain}
\setlength{\droptitle}{30pt}
\maketitle
\end{titlingpage}

\tableofcontents{}

\clearpage

\chapter*{How to read this manual}
\input{readme}

\mainmatter

\part{Syntax}

\chapter{Abstract syntax}\label{cha:metamodel}
\input{metamodel}

\chapter{Textual syntax}\label{cha:textual}
\input{textual}

\chapter{Graphical syntax}\label{cha:graphical}
\input{graphical}

\part{Well-formedness and Semantics}

\chapter{Well-formedness}\label{cha:wf}
\input{wf}

\chapter{Semantics}\label{cha:semantics}
\input{semantics}

\bibliographystyle{plain}
\bibliography{robocert.bib}

\end{document}