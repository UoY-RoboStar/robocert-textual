%!TEX root=./robocert.tex

This section contains well-formedness rules for the metamodel in
\cref{cha:metamodel}.

\todo{These are informal at the moment, and not checked by the validator.}

\section{Packages}\label{sec:wf-top}

These rules concern the definitions in \cref{sec:metamodel-top}.

\section{Sequences}\label{sec:wf-sequences}

These rules concern the definitions in \cref{sec:metamodel-sequences}.

\section{Actions}\label{sec:wf-actions}

These rules concern the definitions in \cref{sec:metamodel-actions}.

\begin{enumerate}
\item
  A \msequence{} \rfcmustnot{} contain more than one \mfinalaction.
  \todo{I keep getting confused as to what the purpose of
    \mfinalaction s is - this and the next rule might not be needed.}
\item
  Any \mfinalaction{} \rfcmust{} be the last action in the topmost
  \msubsequence{} of a \msequence.
\item
  Any \msequencestep{} that has an active gap (one that can permit messages)
  \rfcmust{} have an action with known events.  This is:
  \begin{enumerate}
  \item \marrowaction;
  \item \mfinalaction;
  \item \mloopaction{} with a lower iteration bound of \(1\) and an
    initial \msequencestep{} with an inactive gap and an action with
    known events;
  \item \todo{other fragments}.
  \end{enumerate}
  \todo{It may be easier to restrict gaps in the metamodel so that
    they can only appear on \marrowaction, \mfinalaction, or a
    deadline section starting with one of those two. I'm not sure of
    any situation where we'd want a gap going into anything else, and
    it might complicate Sirius.}
\end{enumerate}

\section{Messages}\label{sec:wf-messages}

These rules concern the definitions in \cref{sec:metamodel-messages}.

\subsection{\mmessagespec}

\paragraph{Actors}

\begin{enumerate}
\item
	Exactly one of the from-- and to-actors of a message spec \rfcmust{} 
	be a \mtarget.
	\todo{not checked by validator yet}
\item
	Exactly one of the from-- and to-actors of a message spec \rfcmust{} 
	be a \mworld.
	\todo{not checked by validator yet}
\end{enumerate}

\paragraph{Arguments}

\begin{enumerate}
\item
	\mrestargument{} \rfcmustnot{} appear anywhere other than as the last
	argument in the list.
	\todo{not checked by validator yet}
\item
	Argument lists \rfcmust{} either end in a \mrestargument, or
	contain exactly as many arguments as the \mmessagetopic{} of the spec
	has parameters.  (An \meventtopic{} is considered to have 1 parameter
	if typed, and 0 otherwise.)
	\todo{not checked by validator yet}
\item
	Argument lists \rfcmustnot{} contain more
	arguments than the \mmessagetopic{} of the spec has parameters.
	As this includes \mrestargument, this means that \mrestargument{} cannot
	appear if all parameters already have arguments.
	\todo{not checked by validator yet}
\item
	\mexpressionargument s \rfcshould{} be literals.  This is a temporary
	limitation, and will be lifted when the CSP generator improves.
	\todo{not checked by validator yet}
\end{enumerate}

\section{Actors}\label{sec:wf-actors}

These rules concern the definitions in \cref{sec:metamodel-actors}.

\section{Assertions}\label{sec:wf-assertions}

These rules concern the definitions in \cref{sec:metamodel-assertions}.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "robocert"
%%% End:
