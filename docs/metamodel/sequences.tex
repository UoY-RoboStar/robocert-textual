%!TEX root=../robocert.tex
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{diagrams/Sequences}
	\caption{Class diagram for the part of the \langname{} metamodel dealing with sequences.}
	\label{fig:metamodel-sequences}
\end{figure}

\Cref{fig:metamodel-sequences} depicts the part of the metamodel concerning
sequence diagrams and their high-level structure.

\subsection{\msequencegroup}

A \msequencegroup{} is a top-level container for sequence diagrams.
It is a \mnamedelement{} that contains:

\begin{itemize}
\item
  two \mactor s (\cref{sec:metamodel-actors}):
  a \mtarget{} (\cref{ssec:metamodel-actors-target})
  and a \mworld{} (\cref{ssec:metamodel-actors-world});
\item
  zero or more \mnamedmessageset{}s (\cref{ssec:metamodel-messages-named-sets});
\item
  zero or more \msequence{} (\cref{ssec:metamodel-sequences-sequences}).
\end{itemize}

\begin{lstlisting}[style=Example]
sequence group Group:
  module AModule  // RCModuleTarget actor
  -> world        // World actor
{
  message set M1: universe
  
  sequence Example1 {
    anything until end
  }
  sequence Example2 {
    anything until end
  }
}
\end{lstlisting}

\subsection{\msequence}\label{ssec:metamodel-sequences-sequences}

A \msequence{} represents a sequence diagram.  It is a \mnamedelement{}
that contains a \msubsequence{} (\cref{ssec:metamodel-sequences-subsequences})
capturing the body of the diagram.

\begin{lstlisting}[style=Example]
sequence Example
{
    anything until end  // Subsequence
}
\end{lstlisting}

\subsection{\msubsequence}\label{ssec:metamodel-sequences-subsequences}

A \msubsequence{} is a sequential composition of one or more \msequencestep s
(\cref{ssec:metamodel-sequences-steps}).
All \msequence s contain exactly one \msubsequence{} at the top level, but
may contain multiple nested \msubsequence s introduced by constructs such as
\mloopaction s.

\begin{lstlisting}[style=Example]
{
    anything until -> operation O1()  // SequenceStep
then
    -> operation O2()                 // SequenceStep
then
    end                               // SequenceStep
}
\end{lstlisting}

\subsection{\msequencestep}\label{ssec:metamodel-sequences-steps}

A \msequencestep{} is a single step in a \msubsequence.  It consists of a
\msequencegap{} (\cref{ssec:metamodel-sequences-gaps}) and a
\msequenceaction{} (\cref{sec:metamodel-actions}).

\begin{lstlisting}[style=Example]
anything until -> operation O()
// SequenceStep with explicit SequenceGap and SequenceAction

-> operation O()
// SequenceStep with explicit SequenceAction only;
// implicit SequenceGap with empty allow set
\end{lstlisting}

\subsection{\msequencegap}\label{ssec:metamodel-sequences-gaps}

A \msequencegap{} represents a condition on any
communication\footnote{In PSCs, this would correspond to
  \emph{intraMSG}s.} that can happen \emph{before} a \msequenceaction.
It contains two \mmessageset s (\cref{ssec:metamodel-messages-sets}):
one specifying the messages \emph{allowed} to pass inside the gap, and
another specifying the messages \emph{forbidden} to pass.

\begin{lstlisting}[style=Example]
anything
    in message set MS
    // allowed RefMessageSet
    // 'in universe' is implied if no 'in SET' is given

    except {| -> operation O2() |}
    // forbidden ExtensionalMessageSet
    // 'except {||}' is implied if no 'except SET' is given
until
\end{lstlisting}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../robocert"
%%% End:
