%!TEX root=../robocert.tex
\begin{figure}[htb]
	\centering
	\includegraphics[width=0.7\textwidth]{diagrams/Actions}
	\caption{Class diagram for the part of the \langname{} metamodel dealing with actions.}
	\label{fig:metamodel-actions}
\end{figure}

An action (\msequenceaction{}) represents a point in time on a
sequence when something is expected to occur.  Unless constrained by
\mdeadlinestep s, any amount of time (including no time at all) may
pass between two \msequenceaction s, or between the start of the
sequence and the first \msequenceaction.  There are three types of
action:
\begin{itemize}
\item \marrowaction{} (\cref{ssec:metamodel-actions-arrows}):
  a communication is expected to occur;
\item \mwaitaction{} (\cref{ssec:metamodel-actions-waits}):
  a delay is expected to occur;
\item \mfinalaction{} (\cref{ssec:metamodel-actions-final}):
  termination is expected to occur.
\end{itemize}

\Cref{fig:metamodel-actions} depicts the part of the metamodel concerning
sequence actions.

\subsection{\marrowaction}\label{ssec:metamodel-actions-arrows}

An \marrowaction\footnote{The name signifies both that the actions resemble
PSC \emph{arrowMSG} specifications, and also that they correspond to arrows in
the graphical syntax.} specifies an expected communication between \mactor s.
Each \marrowaction{} wraps one
\mmessagespec{} (\cref{sec:metamodel-messages})
containing the specification proper.

\begin{figure}[H]
\begin{subfigure}[t]{\egtextwidth}
\begin{lstlisting}[style=Example]
->op O1()
\end{lstlisting}
\end{subfigure}
\hfill
\begin{subfigure}[t]{\eggraphicalwidth}
\gsecaption
\centering
\begin{tikzpicture}
\matrix[diagram]{
    \node[rcmodule](mstart) {\egtarget}; & \node[world](wstart) {\egworld}; \\
	\coordinate(mo); & \coordinate(wo); \\
	\coordinate(mend); & \coordinate(wend); \\
};
\draw[lifeline] (mstart) -- (mo) -- (mend);
\draw[lifeline] (wstart) -- (wo) -- (wend);
\draw (mo) edge[oarrow, "O1()"] (wo);
\end{tikzpicture}
\end{subfigure}

\end{figure}

\subsection{\mwaitaction}\label{ssec:metamodel-actions-waits}

A \mwaitaction{} represents a pause for a specific number of time
units.
\todo{nondeterministic wait}

\begin{remark}
  The effect of a gap specification on a \mwaitaction{} is perhaps
  subtle: the gap remains active until the wait has concluded.  For
  instance, a wait for \(3\) time units allows any communication
  allowed by the gap to occur for \(3\) time units.
\end{remark} 

\begin{figure}[H]
\begin{subfigure}[t]{\egtextwidth}
\begin{lstlisting}[style=Example]
after 3 units
\end{lstlisting}
\end{subfigure}
\hfill
\begin{subfigure}[t]{\eggraphicalwidth}
\gsecaption
\centering
\begin{tikzpicture}
\matrix[diagram]{
    \node[rcmodule](mstart) {\egtarget}; & \node[world](wstart) {\egworld}; \\
	\coordinate(mw); & \coordinate(ww); \\
	\coordinate(mend); & \coordinate(wend); \\
};
\draw[lifeline] (mstart) -- (mw) -- (mend);
\draw[lifeline] (wstart) -- (ww) -- (wend);
\gwait{mw}{ww}{3}
\end{tikzpicture}
\end{subfigure}

\end{figure}

\subsection{\mfinalaction}\label{ssec:metamodel-actions-final}

A \mfinalaction{} captures the eventual successful termination of a
sequence diagram.  A diagram with a \mfinalaction{} specifies a
complete sequence of behaviour from the \mtarget{} initialising to the
\mtarget{} terminating.  Conversely, sequence diagrams without
\mfinalaction s capture partial specifications of behaviour, or the
behaviour of \mtarget s that do not terminate.

\begin{remark}
The gap of a \mfinalaction-carrying \mactionstep{} captures
any permitted communications after the behaviour explicitly specified by the
diagram has occurred.
\end{remark}

\begin{figure}[h!]

\begin{subfigure}[t]{\egtextwidth}
\begin{lstlisting}[style=Example]
end
\end{lstlisting}
\end{subfigure}
\hfill
\begin{subfigure}[t]{\eggraphicalwidth}
\gsecaption
\centering
\begin{tikzpicture}
\matrix[diagram]{
	\node[rcmodule](mstart) {\egtarget}; & \node[world](wstart) {\egworld}; \\
	\coordinate(mend); & \coordinate(wend); \\
};
\draw[lifeline] (mstart) -- (mend);
\draw[lifeline] (wstart) -- (wend);
\gfinal{mend}{wend}
\end{tikzpicture}
\end{subfigure}

\end{figure}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../robocert"
%%% End:
